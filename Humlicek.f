      SUBROUTINE CPF12(X, Y, WR, WI)
C ROUTINE COMPUTES THE REAL (WR) AND IMAGINARY (WI) PARTS OF THE COMPLEX
C PROBABILITY FUNCTION W(Z)=EXP(-Z**2)*ERF(-I*Z) IN THE UPPER HALF PLANE
C Z=X+I*Y (I.E. FOR Y>=0)
C MAXIMUM RELATIVE ERROR OF WR IS <2*10**(-6), THAT OF WI <5*10**(-6)
      DIMENSION T(6),C(6),S(6)
      DATA(T(I),I=1,6)/.31424076,.947788391,1.59768264,2.27950708,3.020
     *63703,3.8897249/,(C(I),I=1,6)/1.01172805,-.75197147,1.2557727E-2,
     *1.00220082E-2,-2.42068135E-4,5.00848061E-7/,(S(I),I=1,6)/1.393237,
     *.231152406,-.155351466,6.21836624E-3,9.19082986E-5,-6.27525958E-7/
      WR=0
      WI=0
      Y1=Y+1.5
      Y2=Y1*Y1
C IF HIGH RELATIVE ACCURACY IN REGION ii IS NOT REQUIRED, THE FOLLOWING
C 19 LINES MAY BE DELETED
      IF(Y.GT.0.85.OR.ABS(X).LT.18.1*Y+1.65)GOTO 2
C REGION II
      IF(ABS(X).LT.12.)WR=EXP(-X*X)
      Y3=Y+3
      DO 1 I=1,6
      R=X-T(I)
      R2=R*R
      D=1./(R2+Y2)
      D1=Y1*D
      D2=R*D
      WR=WR+Y*(C(I)*(R*D2
