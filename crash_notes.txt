Breakpoint 2, dp86co (n=5, fcn=0x4431eb <derivs>, x=1.683621724859294, y=..., 
    xend=-6.3323766752450039, hmax=8.6773674721849758, 
    h=-5.8828317906148631e-05, rtol=..., atol=..., itol=0, iprint=6, 
    solout=0x438eab <solout>, iout=1, idid=-3, nmax=100000, 
    uround=2.2999999999999999e-16, meth=1, nstiff=1000, 
    safe=0.90000000000000002, beta=0, fac1=0.33300000000000002, fac2=6, 
    k1=..., k2=..., k3=..., k4=..., k5=..., k6=..., k7=..., k8=..., k9=..., 
    k10=..., y1=..., cont=..., icomp=..., nrd=0, rpar=..., ipar=..., 
    nfcn=32891, nstep=2773, naccpt=2386, nrejct=372) at dop853.f:669
669           IF(ERR.LE.1.D0)THEN
4: ERR = 0.81189007837006766
3: HNEW = -5.4342771752619035e-05
2: H = -5.8828317906148631e-05
1: X = 1.683621724859294
(gdb) break dop853.f:640
Breakpoint 3 at 0x4036af: file dop853.f, line 640.
(gdb) c
Continuing.

Breakpoint 3, dp86co (n=5, fcn=0x4431eb <derivs>, x=1.6835628965413878, y=..., 
    xend=-6.3323766752450039, hmax=8.6773674721849758, 
    h=-5.4342771752619035e-05, rtol=..., atol=..., itol=0, iprint=6, 
    solout=0x438eab <solout>, iout=1, idid=-3, nmax=100000, 
    uround=2.2999999999999999e-16, meth=1, nstiff=1000, 
    safe=0.90000000000000002, beta=0, fac1=0.33300000000000002, fac2=6, 
    k1=..., k2=..., k3=..., k4=..., k5=..., k6=..., k7=..., k8=..., k9=..., 
    k10=..., y1=..., cont=..., icomp=..., nrd=0, rpar=..., ipar=..., 
    nfcn=32903, nstep=2774, naccpt=2387, nrejct=372) at dop853.f:640
640           ERR=0.D0
4: ERR = 0.81189007837006766
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) display ERR2
5: ERR2 = 84456765386.28331
(gdb) display I
6: I = 6
(gdb) display SK
7: SK = 16094313725.601583
(gdb) display ERRI
8: ERRI = 0.8768310546875
(gdb) display ERR2
9: ERR2 = 84456765386.28331
(gdb) s
641           ERR2=0.D0
9: ERR2 = 84456765386.28331
8: ERRI = 0.8768310546875
7: SK = 16094313725.601583
6: I = 6
5: ERR2 = 84456765386.28331
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) s
642           IF (ITOL.EQ.0) THEN   
9: ERR2 = 0
8: ERRI = 0.8768310546875
7: SK = 16094313725.601583
6: I = 6
5: ERR2 = 0
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) s
643             DO 41 I=1,N 
9: ERR2 = 0
8: ERRI = 0.8768310546875
7: SK = 16094313725.601583
6: I = 6
5: ERR2 = 0
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) s
644             SK=ATOLI+RTOLI*MAX(ABS(Y(I)),ABS(K5(I)))
9: ERR2 = 0
8: ERRI = 0.8768310546875
7: SK = 16094313725.601583
6: I = 1
5: ERR2 = 0
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
645             ERRI=K4(I)-BHH1*K1(I)-BHH2*K9(I)-BHH3*K3(I)
9: ERR2 = 0
8: ERRI = 0.8768310546875
7: SK = 16021978396.814684
6: I = 1
5: ERR2 = 0
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
646             ERR2=ERR2+(ERRI/SK)**2
9: ERR2 = 0
8: ERRI = -36755.185974121094
7: SK = 16021978396.814684
6: I = 1
5: ERR2 = 0
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
648          &      +ER10*K10(I)+ER11*K2(I)+ER12*K3(I)
9: ERR2 = 5.2626557901350987e-12
8: ERRI = -36755.185974121094
7: SK = 16021978396.814684
6: I = 1
5: ERR2 = 5.2626557901350987e-12
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
649       41    ERR=ERR+(ERRI/SK)**2
9: ERR2 = 5.2626557901350987e-12
8: ERRI = -10200.468383789062
7: SK = 16021978396.814684
6: I = 1
5: ERR2 = 5.2626557901350987e-12
4: ERR = 0
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
643             DO 41 I=1,N 
9: ERR2 = 5.2626557901350987e-12
8: ERRI = -10200.468383789062
7: SK = 16021978396.814684
6: I = 1
5: ERR2 = 5.2626557901350987e-12
4: ERR = 4.0532924948309549e-13
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
644             SK=ATOLI+RTOLI*MAX(ABS(Y(I)),ABS(K5(I)))
9: ERR2 = 5.2626557901350987e-12
8: ERRI = -10200.468383789062
7: SK = 16021978396.814684
6: I = 2
5: ERR2 = 5.2626557901350987e-12
4: ERR = 4.0532924948309549e-13
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
645             ERRI=K4(I)-BHH1*K1(I)-BHH2*K9(I)-BHH3*K3(I)
9: ERR2 = 5.2626557901350987e-12
8: ERRI = -10200.468383789062
7: SK = 28.801016189646919
6: I = 2
5: ERR2 = 5.2626557901350987e-12
4: ERR = 4.0532924948309549e-13
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
646             ERR2=ERR2+(ERRI/SK)**2
9: ERR2 = 5.2626557901350987e-12
8: ERRI = -8.6779541219102612
7: SK = 28.801016189646919
6: I = 2
5: ERR2 = 5.2626557901350987e-12
4: ERR = 4.0532924948309549e-13
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
648          &      +ER10*K10(I)+ER11*K2(I)+ER12*K3(I)
9: ERR2 = 0.090786040842630436
8: ERRI = -8.6779541219102612
7: SK = 28.801016189646919
6: I = 2
5: ERR2 = 0.090786040842630436
4: ERR = 4.0532924948309549e-13
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
649       41    ERR=ERR+(ERRI/SK)**2
9: ERR2 = 0.090786040842630436
8: ERRI = -2.5132934074481454
7: SK = 28.801016189646919
6: I = 2
5: ERR2 = 0.090786040842630436
4: ERR = 4.0532924948309549e-13
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
643             DO 41 I=1,N 
9: ERR2 = 0.090786040842630436
8: ERRI = -2.5132934074481454
7: SK = 28.801016189646919
6: I = 2
5: ERR2 = 0.090786040842630436
4: ERR = 0.0076150149719701387
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
644             SK=ATOLI+RTOLI*MAX(ABS(Y(I)),ABS(K5(I)))
9: ERR2 = 0.090786040842630436
8: ERRI = -2.5132934074481454
7: SK = 28.801016189646919
6: I = 3
5: ERR2 = 0.090786040842630436
4: ERR = 0.0076150149719701387
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
645             ERRI=K4(I)-BHH1*K1(I)-BHH2*K9(I)-BHH3*K3(I)
9: ERR2 = 0.090786040842630436
8: ERRI = -2.5132934074481454
7: SK = 1.5316035021078643e-322
6: I = 3
5: ERR2 = 0.090786040842630436
4: ERR = 0.0076150149719701387
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
646             ERR2=ERR2+(ERRI/SK)**2
9: ERR2 = 0.090786040842630436
8: ERRI = 4.9376426579728338e-318
7: SK = 1.5316035021078643e-322
6: I = 3
5: ERR2 = 0.090786040842630436
4: ERR = 0.0076150149719701387
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
648          &      +ER10*K10(I)+ER11*K2(I)+ER12*K3(I)
9: ERR2 = 1039313602.6922429
8: ERRI = 4.9376426579728338e-318
7: SK = 1.5316035021078643e-322
6: I = 3
5: ERR2 = 1039313602.6922429
4: ERR = 0.0076150149719701387
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
649       41    ERR=ERR+(ERRI/SK)**2
9: ERR2 = 1039313602.6922429
8: ERRI = -3.679306864579763e-319
7: SK = 1.5316035021078643e-322
6: I = 3
5: ERR2 = 1039313602.6922429
4: ERR = 0.0076150149719701387
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
643             DO 41 I=1,N 
9: ERR2 = 1039313602.6922429
8: ERRI = -3.679306864579763e-319
7: SK = 1.5316035021078643e-322
6: I = 3
5: ERR2 = 1039313602.6922429
4: ERR = 5770843.816147794
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
644             SK=ATOLI+RTOLI*MAX(ABS(Y(I)),ABS(K5(I)))
9: ERR2 = 1039313602.6922429
8: ERRI = -3.679306864579763e-319
7: SK = 1.5316035021078643e-322
6: I = 4
5: ERR2 = 1039313602.6922429
4: ERR = 5770843.816147794
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) 
645             ERRI=K4(I)-BHH1*K1(I)-BHH2*K9(I)-BHH3*K3(I)
9: ERR2 = 1039313602.6922429
8: ERRI = -3.679306864579763e-319
7: SK = 0
6: I = 4
5: ERR2 = 1039313602.6922429
4: ERR = 5770843.816147794
3: HNEW = -5.4342771752619035e-05
2: H = -5.4342771752619035e-05
1: X = 1.6835628965413878
(gdb) display Y
10: Y = (16021978396814.684, -28801.016189646918, -1.5073942854616432e-319, -1.6304166312761136e-321, 16093841157221.82)
(gdb) display K5
11: K5 = (16021541068959.525, -28795.863344435365, -5.6367949534027818e-320, -6.0770074438473325e-322, 16093404673309.9)
(gdb) display RTOLI
12: RTOLI = 0.001
(gdb) display ATOLI
13: ATOLI = 0
(gdb) 


Relevant section of dop853.f
=============================================
  35  K5(I)=Y(I)+H*K4(I)
C --- ERROR ESTIMATION  
      ERR=0.D0
      ERR2=0.D0
      IF (ITOL.EQ.0) THEN
        DO 41 I=1,N
        SK=ATOLI+RTOLI*MAX(ABS(Y(I)),ABS(K5(I)))   <-This line becomes 0
        ERRI=K4(I)-BHH1*K1(I)-BHH2*K9(I)-BHH3*K3(I)
        ERR2=ERR2+(ERRI/SK)**2
        ERRI=ER1*K1(I)+ER6*K6(I)+ER7*K7(I)+ER8*K8(I)+ER9*K9(I)
     &      +ER10*K10(I)+ER11*K2(I)+ER12*K3(I)
  41    ERR=ERR+(ERRI/SK)**2
      ELSE
        DO 42 I=1,N
        SK=ATOL(I)+RTOL(I)*MAX(ABS(Y(I)),ABS(K5(I)))
        ERRI=K4(I)-BHH1*K1(I)-BHH2*K9(I)-BHH3*K3(I)
        ERR2=ERR2+(ERRI/SK)**2
        ERRI=ER1*K1(I)+ER6*K6(I)+ER7*K7(I)+ER8*K8(I)+ER9*K9(I)
     &      +ER10*K10(I)+ER11*K2(I)+ER12*K3(I)
  42    ERR=ERR+(ERRI/SK)**2
      END IF
      DENO=ERR+0.01D0*ERR2
      IF (DENO.LE.0.D0) DENO=1.D0
      ERR=ABS(H)*ERR*SQRT(1.D0/(N*DENO))
C --- COMPUTATION OF HNEW
      FAC11=ERR**EXPO1
C --- LUND-STABILIZATION
      FAC=FAC11/FACOLD**BETA
C --- WE REQUIRE  FAC1 <= HNEW/H <= FAC2
      FAC=MAX(FACC2,MIN(FACC1,FAC/SAFE))
      HNEW=H/FAC

